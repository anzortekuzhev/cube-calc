<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Калькулятор рассрочки CUBE</title>
  <style>
    @font-face {
      font-family: 'SF Pro Text';
      src: local('SF Pro Text'), local('San Francisco');
    }
    body {
      margin: 0;
      padding: 0;
      font-family: 'SF Pro Text', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: linear-gradient(90deg, #000000, #737373);
      color: white;
      display: flex;
      justify-content: center;
    }
    .container {
      max-width: 420px;
      width: 100%;
      padding: 20px;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    h1 {
      font-size: 26px;
      text-align: center;
    }
    label {
      font-size: 14px;
      display: block;
      margin-top: 14px;
      align-self: flex-start;
    }
    input[type="number"], select {
      width: 100%;
      padding: 10px;
      font-size: 14px;
      border-radius: 30px;
      border: 2px solid #D9D9D9;
      background: transparent;
      color: white;
    }
    input[type="range"] {
      width: 100%;
      height: 6px;
      margin-top: 5px;
      border-radius: 5px;
      background: #e8d7c9;
      outline: none;
      appearance: none;
      transition: background 450ms ease-in;
    }
    input[type="range"]::-webkit-slider-thumb {
      appearance: none;
      width: 16px;
      height: 16px;
      border-radius: 50%;
      background: white;
      cursor: pointer;
    }
    .result {
      margin-top: 20px;
      background: rgba(255, 255, 255, 0.1);
      padding: 16px;
      border-radius: 20px;
      font-size: 14px;
      width: 100%;
    }
    .whatsapp-button {
      margin-top: 20px;
      background-color: #25D366;
      padding: 12px 20px;
      border-radius: 30px;
      font-weight: bold;
      color: white;
      text-decoration: none;
      display: inline-flex;
      align-items: center;
      justify-content: center;
    }
    .whatsapp-button img {
      width: 18px;
      height: 18px;
      margin-left: 10px;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Калькулятор рассрочки</h1>


    <label>Выберите товар:</label>
    <select id="product">
      <option value="">— Выберите —</option>
      <optgroup label="Техника Apple">
  <optgroup label="iPhone">
    <optgroup label="iPhone 16 Pro Max">
      <option value="144900">iPhone 16 Pro Max 1TB — 144 900 ₽</option>
      <option value="134900">iPhone 16 Pro Max 512gb — 134 900 ₽</option>
      <option value="114900">iPhone 16 Pro Max 256gb — 114 900 ₽</option>
    </optgroup>
    <optgroup label="iPhone 16 Pro">
      <option value="139900">iPhone 16 Pro 1TB — 139 900 ₽</option>
      <option value="124900">iPhone 16 Pro 512gb — 124 900 ₽</option>
      <option value="104900">iPhone 16 Pro 256gb — 104 900 ₽</option>
      <option value="94900">iPhone 16 Pro 128gb — 94 900 ₽</option>
    </optgroup>
    <optgroup label="iPhone 16 Plus">
      <option value="87900">iPhone 16 Plus 256gb — 87 900 ₽</option>
      <option value="77900">iPhone 16 Plus 128gb — 77 900 ₽</option>
    </optgroup>
    <optgroup label="iPhone 16">
      <option value="77900">iPhone 16 256gb — 77 900 ₽</option>
      <option value="67900">iPhone 16 128gb — 67 900 ₽</option>
    </optgroup>
    <optgroup label="iPhone 16E">
      <option value="54900">iPhone 16E 128gb — 54 900 ₽</option>
    </optgroup>
    <optgroup label="iPhone 15">
      <option value="66900">iPhone 15 Plus 128gb — 66 900 ₽</option>
      <option value="72900">iPhone 15 256gb — 72 900 ₽</option>
      <option value="61900">iPhone 15 128gb — 61 900 ₽</option>
    </optgroup>
    <optgroup label="iPhone 14">
      <option value="61900">iPhone 14 256gb — 61 900 ₽</option>
      <option value="54900">iPhone 14 128gb — 54 900 ₽</option>
    </optgroup>
    <optgroup label="iPhone 13">
      <option value="46900">iPhone 13 128gb — 46 900 ₽</option>
    </optgroup>
    <optgroup label="iPhone 12">
      <option value="44900">iPhone 12 128gb — 44 900 ₽</option>
      <option value="39900">iPhone 12 64gb — 39 900 ₽</option>
    </optgroup>
  </optgroup>
  <optgroup label="iPad">
    <optgroup label="iPad Pro">
      <option value="129900">iPad Pro M4 13″ 256gb Cellular — 129 900 ₽</option>
      <option value="109900">iPad Pro M4 13″ 256gb Wi-Fi — 109 900 ₽</option>
      <option value="115900">iPad Pro M4 11″ 512gb Wi-Fi — 115 900 ₽</option>
      <option value="89900">iPad Pro M4 11″ 256gb Wi-Fi — 89 900 ₽</option>
    </optgroup>
    <optgroup label="iPad Air">
      <option value="79900">iPad Air 6 13″ M2 128gb Wi-Fi — 79 900 ₽</option>
      <option value="66900">iPad Air 6 11″ M2 256gb Wi-Fi — 66 900 ₽</option>
      <option value="64900">iPad Air 7 11″ M3 128gb Wi-Fi — 64 900 ₽</option>
      <option value="56900">iPad Air 6 11″ M2 128gb Wi-Fi — 56 900 ₽</option>
    </optgroup>
    <optgroup label="iPad 11">
      <option value="52900">iPad 11 256gb Wi-Fi — 52 900 ₽</option>
    </optgroup>
    <optgroup label="iPad 10">
      <option value="47900">iPad 10 256gb Wi-Fi — 47 900 ₽</option>
      <option value="36900">iPad 10 64gb Wi-Fi — 36 900 ₽</option>
    </optgroup>
    <optgroup label="iPad mini 7">
      <option value="49900">iPad mini 7 128gb Wi-Fi — 49 900 ₽</option>
    </optgroup>
  </optgroup>
  <optgroup label="MacBook">
    <option value="185900">MacBook Pro 14″ M4 Pro 24/512gb — 185 900 ₽</option>
    <option value="134900">MacBook Air 15″ M3 16/256gb — 134 900 ₽</option>
    <option value="125900">MacBook Air 15″ M3 8/256gb — 125 900 ₽</option>
    <option value="125900">MacBook Air 13.6″ M3 16/512gb — 125 900 ₽</option>
    <option value="107900">MacBook Air 13.6″ M3 16/256gb — 107 900 ₽</option>
    <option value="97900">MacBook Air 13.6″ M3 8/256gb — 97 900 ₽</option>
    <option value="87900">MacBook Air 13.6″ M2 16/256gb — 87 900 ₽</option>
    <option value="84900">MacBook Air 13.6″ M2 8/256gb — 84 900 ₽</option>
    <option value="67900">MacBook Air 13″ M1 8/256gb — 67 900 ₽</option>
  </optgroup>
  <optgroup label="iMac">
    <option value="149900">iMac 24″ на процессоре M4 — от 149 900 ₽</option>
  </optgroup>
</optgroup>
<optgroup label="Apple Watch">
  <option value="74900">Apple Watch Ultra 2 49mm Black — 74 900 ₽</option>
  <option value="72900">Apple Watch Ultra 2 49mm — 72 900 ₽</option>
  <option value="39900">Apple Watch 10 46mm — 39 900 ₽</option>
  <option value="37900">Apple Watch 10 42mm — 37 900 ₽</option>
  <option value="33900">Apple Watch 9 45mm — 33 900 ₽</option>
  <option value="26900">Apple Watch SE 44mm 2024 — 26 900 ₽</option>
  <option value="24900">Apple Watch SE 40mm 2024 — 24 900 ₽</option>
  <option value="24900">Apple Watch SE 44mm 2023 — 24 900 ₽</option>
  <option value="22900">Apple Watch SE 44mm 2022 — 22 900 ₽</option>
</optgroup>
<optgroup label="AirPods">
  <option value="49900">AirPods Max 2024 — 49 900 ₽</option>
  <option value="17900">AirPods 4 ANC — 17 900 ₽</option>
  <option value="19900">AirPods Pro 2 — 19 900 ₽</option>
  <option value="13900">AirPods 4 — 13 900 ₽</option>
  <option value="13900">AirPods 3 — 13 900 ₽</option>
  <option value="10900">AirPods 2 — 10 900 ₽</option>
</optgroup>
<optgroup label="Аксессуары">
  <option value="11900">Apple Magic Mouse 3 — 11 900 ₽</option>
  <option value="14900">Apple Pencil Pro — 14 900 ₽</option>
  <option value="10900">Apple Pencil 2 — 10 900 ₽</option>
  <option value="29900">Apple Magic Keyboard iPad 11″ — 29 900 ₽</option>
  <option value="33900">Apple Magic Keyboard iPad 13″ — 33 900 ₽</option>
</optgroup>
<optgroup label="Samsung">
  <optgroup label="S-серия">
    <option value="104900">Samsung S25 Ultra 12/512gb — 104 900 ₽</option>
    <option value="94900">Samsung S25 Ultra 12/256gb — 94 900 ₽</option>
    <option value="79900">Samsung S25 Plus 12/256gb — 79 900 ₽</option>
    <option value="74900">Samsung S25 12/256gb — 74 900 ₽</option>
  </optgroup>
  <optgroup label="S24-серия">
    <option value="89900">Samsung S24 Ultra 12/512gb — 89 900 ₽</option>
    <option value="79900">Samsung S24 Ultra 12/256gb — 79 900 ₽</option>
    <option value="55900">Samsung S24 8/128gb — 55 900 ₽</option>
    <option value="45900">Samsung S24 FE 8/256gb — 45 900 ₽</option>
  </optgroup>
  <optgroup label="S23">
    <option value="49900">Samsung S23 128gb — 49 900 ₽</option>
  </optgroup>
  <optgroup label="A-серия">
    <option value="37900">Samsung A56 8/256gb — 37 900 ₽</option>
    <option value="34900">Samsung A56 8/128gb — 34 900 ₽</option>
    <option value="34900">Samsung A55 8/256gb — 34 900 ₽</option>
    <option value="29900">Samsung A55 8/128gb — 29 900 ₽</option>
    <option value="24900">Samsung A54 8/128gb — 24 900 ₽</option>
    <option value="33900">Samsung A36 8/256gb — 33 900 ₽</option>
    <option value="31900">Samsung A36 8/128gb — 31 900 ₽</option>
    <option value="27900">Samsung A35 8/256gb — 27 900 ₽</option>
    <option value="25900">Samsung A35 8/128gb — 25 900 ₽</option>
    <option value="19900">Samsung A25 6/128gb — 19 900 ₽</option>
    <option value="15900">Samsung A24 4/128gb — 15 900 ₽</option>
    <option value="15900">Samsung A16 6/128gb — 15 900 ₽</option>
    <option value="14900">Samsung A16 4/128gb — 14 900 ₽</option>
  </optgroup>
</optgroup>
<optgroup label="Техника Xiaomi">
  <optgroup label="Poco">
    <option value="35900">Poco X7 Pro 12/512gb — 35 900 ₽</option>
    <option value="31900">Poco X7 Pro 8/256gb — 31 900 ₽</option>
    <option value="19900">Poco F4 6/128gb — 19 900 ₽</option>
    <option value="29900">Poco X6 Pro 12/512gb — 29 900 ₽</option>
    <option value="23900">Poco X5 Pro 8/256gb — 23 900 ₽</option>
    <option value="19900">Poco X5 Pro 6/128gb — 19 900 ₽</option>
    <option value="19900">Poco X5 8/256gb — 19 900 ₽</option>
  </optgroup>
  <optgroup label="Redmi Note 14">
    <option value="34900">Redmi Note 14 Pro Plus 8/256gb — 34 900 ₽</option>
    <option value="29900">Redmi Note 14 Pro 12/512gb — 29 900 ₽</option>
    <option value="25900">Redmi Note 14 Pro 8/256gb — 25 900 ₽</option>
    <option value="18900">Redmi Note 14 8/256gb — 18 900 ₽</option>
    <option value="16900">Redmi Note 14 8/128gb — 16 900 ₽</option>
    <option value="14900">Redmi Note 14 6/128gb — 14 900 ₽</option>
  </optgroup>
  <optgroup label="Redmi Note 13">
    <option value="24900">Redmi Note 13 Pro 12/256gb — 24 900 ₽</option>
    <option value="19900">Redmi Note 13 Pro 8/256gb — 19 900 ₽</option>
  </optgroup>
  <optgroup label="Redmi Note 12 / 11">
    <option value="12900">Redmi Note 12 6/128gb — 12 900 ₽</option>
    <option value="14900">Redmi Note 11 Pro 8/128gb — 14 900 ₽</option>
  </optgroup>
  <optgroup label="Redmi 14C">
    <option value="12900">Redmi 14C 8/256gb — 12 900 ₽</option>
    <option value="9900">Redmi 14C 4/128gb — 9 900 ₽</option>
  </optgroup>
  <optgroup label="Redmi Pad">
    <option value="29900">Планшет Redmi Pad Pro 12′ 8/256gb — 29 900 ₽</option>
    <option value="18900">Планшет Redmi Pad SE 6/128gb — 18 900 ₽</option>
    <option value="20900">Планшет Redmi Pad SE 8/256gb — 20 900 ₽</option>
    <option value="15900">Планшет Redmi Pad SE 8.7 4/128gb — 15 900 ₽</option>
  </optgroup>
</optgroup>
<optgroup label="Бытовая техника и электроника">
  <optgroup label="Пылесосы">
    <option value="68900">Беспроводной пылесос Dyson Gen5 Detect Absolute (SV23) — 68 900 ₽</option>
    <option value="44900">Беспроводной пылесос Roborock Dyad Pro Combo — 44 900 ₽</option>
    <option value="34900">Беспроводной пылесос Roborock Flexi Pro — 34 900 ₽</option>
    <option value="26900">Беспроводной пылесос Roborock Flexi Lite — 26 900 ₽</option>
    <option value="22900">Робот-пылесос Xiaomi Robot Vacuum S12 — 22 900 ₽</option>
    <option value="13900">Робот-пылесос Xiaomi Mijia G1 — 13 900 ₽</option>
  </optgroup>
  <optgroup label="PlayStation">
    <option value="79900">Sony PlayStation 5 Pro 2TB — 79 900 ₽</option>
    <option value="53900">Sony PlayStation 5 Slim — 53 900 ₽</option>
  </optgroup>
  <optgroup label="Укладка и уход Dyson">
   <optgroup label="Выпрямители Dyson">
    <option value="49900">Dyson AirStrait HT01 Blue Copper — 49 900 ₽</option>
    <option value="49900">Dyson AirStrait HT01 Red Velvet Gold — 49 900 ₽</option>
    <option value="49900">Dyson AirStrait HT01 Ceramic Pink Rose Gold — 49 900 ₽</option>
    <option value="49900">Dyson AirStrait HT01 Strawberry Bronze Pink — 49 900 ₽</option>
   <optgroup label="Стайлеры Dyson">
    <option value="54900">Dyson HSO5 Airwrap Long Nickel Copper — 54 900 ₽</option>
    <option value="54900">Dyson HSO5 Airwrap Long Blue blush — 54 900 ₽</option>
    <option value="54900">Dyson HSO5 Airwrap Long Fuchsia Nickel — 54 900 ₽</option>
    <option value="59900">Dyson HSO5 Airwrap Long Onyx Gold — 59 900 ₽</option>
    <option value="59900">Dyson HSO5 Airwrap Long Diffuse volumise Blue Copper — 59 900 ₽</option>
    <option value="59900">Dyson HS08 Airwrap ID Long Vinca blue topaz — 59 900 ₽</option>
    <option value="64900">Dyson HS08 Airwrap ID Long Jasper Plum Purple — 64 900 ₽</option>
  </optgroup>
</optgroup>
    </select>

    <label>Стоимость товара (₽):</label>
    <input type="number" id="price" max="300000" value="10000" />
    <input type="range" id="priceRange" min="10000" max="300000" step="1000" value="10000" />

    <label>Первый взнос (₽):</label>
    <small style="align-self: flex-start; font-size: 12px; opacity: 0.8;">(минимум 30% от суммы)</small>
    <input type="number" id="down" value="3000" />
    <input type="range" id="downRange" min="0" max="300000" step="1000" value="3000" />
    <div id="downError" style="color: #ff8080; font-size: 13px; margin-top: 4px; display: none;">
  Первый взнос должен быть не менее 30% от стоимости товара
</div>


    <label>Срок рассрочки (мес.):</label>
    <input type="number" id="months" min="1" max="12" value="6" />
    <input type="range" id="monthsRange" min="1" max="12" value="6" />

    <div class="result" id="resultBox"></div>

    <a class="whatsapp-button" id="whatsappLink" href="#" target="_blank">
      Оставить заявку <img src="https://upload.wikimedia.org/wikipedia/commons/6/6b/WhatsApp.svg" />
    </a>
  </div>

  <script>
    function getMonthlyRate(months) {
      return months <= 6 ? 0.06 : 0.07;
    }

    function format(num) {
      const rounded = Math.round(num / 10) * 10;
      return rounded.toLocaleString('ru-RU');
    }

    function unformat(str) {
      return parseFloat(str.toString().replace(/\s/g, '')) || 0;
    }

    function updateSliderBackground(slider) {
      const val = (slider.value - slider.min) / (slider.max - slider.min) * 100;
      slider.style.background = `linear-gradient(to right, #e8d7c9 0%, #e8d7c9 ${val}%, rgba(232,215,201,0.3) ${val}%, rgba(232,215,201,0.3) 100%)`;
    }

    function sync(slider, input, resetProduct = false) {
      const update = () => {
        const rawValue = unformat(input.value);
        slider.value = rawValue;
        if (resetProduct) document.getElementById('product').value = "";
        updateSliderBackground(slider);
        validateDown();
        calc();
        updateWhatsAppLink();
      };
      slider.addEventListener('input', () => {
        input.value = slider.value;
        if (resetProduct) document.getElementById('product').value = "";
        updateSliderBackground(slider);
        validateDown();
        calc();
        updateWhatsAppLink();
      });
      input.addEventListener('input', update);
      input.addEventListener('blur', () => {
        input.value = format(unformat(input.value));
      });
      updateSliderBackground(slider);
    }

    function validateDown() {
      const price = unformat(document.getElementById('price').value);
      const down = document.getElementById('down');
      const downRange = document.getElementById('downRange');
      if (!isNaN(price)) {
        const min = 0;
        const max = price;
        down.min = min;
        down.max = max;
        downRange.min = min;
        downRange.max = max;

        if (parseFloat(down.value) < min) {
          down.value = min;
          downRange.value = min;
        }

        updateSliderBackground(downRange);
      }
    }

    function calc() {
      const price = unformat(document.getElementById('price').value);
      const down = unformat(document.getElementById('down').value);
      const months = parseInt(document.getElementById('months').value);
      const box = document.getElementById('resultBox');
      if (!price || !down || !months || down >= price) {
        box.innerHTML = '';
        return;
      }
      const rate = getMonthlyRate(months);
      const credit = price - down;
      const total = credit * (1 + rate * months);
      const monthly = total / months;
      const overpay = total - credit;
      const fullTotal = total + down;
      box.innerHTML = `
        <p><strong>Ежемесячный платёж:</strong> ${format(monthly)} ₽</p>
        <p><strong>Общая стоимость:</strong> ${format(fullTotal)} ₽</p>
        <p><strong>Торговая наценка:</strong> ${format(overpay)} ₽</p>
      `;
    }

    const price = document.getElementById('price');
    const priceRange = document.getElementById('priceRange');
    const down = document.getElementById('down');
    const downRange = document.getElementById('downRange');
    const months = document.getElementById('months');
    const monthsRange = document.getElementById('monthsRange');
    const whatsappLink = document.getElementById('whatsappLink');
    const productSelect = document.getElementById('product');

    document.getElementById('product').addEventListener('change', (e) => {
      if (e.target.value) {
        price.value = e.target.value;
        priceRange.value = e.target.value;
        updateSliderBackground(priceRange);
        validateDown();
        calc();
        updateWhatsAppLink();
      }
    });

    sync(priceRange, price, true);
    sync(downRange, down);
    sync(monthsRange, months);

    function updateWhatsAppLink() {
      const productText = productSelect.options[productSelect.selectedIndex]?.text || '';
      const downPayment = unformat(document.getElementById('down').value);
      const monthsValue = document.getElementById('months').value;
      const price = unformat(document.getElementById('price').value);

      const minDown = price * 0.3;
      const errorBox = document.getElementById('downError');
      if (!productText || downPayment < minDown || !monthsValue) {
    whatsappLink.href = "#";
    if (downPayment < minDown) {
        errorBox.style.display = "block";
    } else {
        errorBox.style.display = "none";
    }
    return;
}
errorBox.style.display = "none";


      const rate = getMonthlyRate(parseInt(monthsValue));
      const credit = price - downPayment;
      const total = credit * (1 + rate * monthsValue);
      const monthly = total / monthsValue;
      const fullTotal = total + downPayment;

      const message = `Ас саламу алайкум! Хочу оформить рассрочку:\n\n📱 Товар: ${productText}\n💰 Первый взнос: ${format(downPayment)} ₽\n📆 Срок: ${monthsValue} мес.\n📤 Платёж в месяц: ${format(monthly)} ₽\n💳 Общая стоимость: ${format(fullTotal)} ₽`;

      const encodedMessage = encodeURIComponent(message);
      whatsappLink.href = `https://wa.me/79627721490?text=${encodedMessage}`;
    }

    updateWhatsAppLink();
  </script>
</body>
</html>
